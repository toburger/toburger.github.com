<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Import NuGet packages to F# interactive scripts</title>
  <meta name="description" content="F#, C#, PowerShell and HTML5 developer; interested in everything tech-related with a strong focus on Microsoft technology." />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="canonical" href="http://toburger.github.io/fsharp/2014/03/26/import-nuget-packages-to-fsharp-interactive-scripts.html">

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
<!--  <link rel="stylesheet" href=""> -->
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" >

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
  <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>

  <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
  <script type="text/javascript" src="/assets/js/index.js"></script>
  <script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->

<a href="http://toburger.github.io" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/df_logo.jpg)"></span></a>

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="article-image">
          <div class="post-image-image" style="background-image: url(/assets/article_images/2014-03-26-import-nuget-packages-to-fsharp-interactive-scripts/desktop.jpg)">
            Article Image
          </div>
          <div class="post-meta">
            <h1 class="post-title">Import NuGet packages to F# interactive scripts</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/assets/images/author.png)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Tobias Burger</h4>
              on
              <time datetime="2014-03-26 00:00">26 Mar 2014</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
            <div style="text-align:center">
              <a href="#topofpage" class="topofpage"><i class="fa fa-angle-down"></i></a>
            </div>
          </div>
        </div>
        <script>
          (function ($) {
              "use strict";
              $(document).ready(function(){
                  var $window = $(window),
                      $image = $('.post-image-image');
                  $window.on('scroll', function() {
                      var top = $window.scrollTop();

                      if (top < 0 || top > 1500) { return; }
                      $image
                          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
                          .css('opacity', 1-Math.max(top/700, 0));
                  });
                  $window.trigger('scroll');

                  var height = $('.article-image').height();
                      $('.post-content').css('padding-top', height + 'px');

                  $(function() {
                    $('a[href*=#]:not([href=#])').click(function() {
                      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
                        var target = $(this.hash);
                        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
                        if (target.length) {
                          $('html,body').animate({
                            scrollTop: target.offset().top
                          }, 500);
                          return false;
                        }
                      }
                    });
                  });

              });

          }(jQuery));
        </script>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>Yes, it’s been a long time (exactly one year, but that’s a coincidence) since my last blog post. The main reason was that in the last year I learnt F# and slowly I have the feeling that I have understood the language and especially the paradigm shift that comes with F#.</p>

<p><em>I jump over the usual homage of why F# is a wonderful language – that’s material for a plethora of blog posts – and come straight to the motivation of this blog post.</em></p>

<p>If you are like me and you learn by trying things out you probably love the interactive and iterative nature of F#. Just create a new fsx (F# Interactive) file and start hacking until you have a working prototype. You don’t even have to save the file!
I actually have a folder full of F# scripts with my experimentations in them.</p>

<p>One pain point though is that F# interactive does not have support for NuGet package management. You can reference the library files manually but that’s very cumbersome.</p>

<p>There exists an older <a href="http://bloggemdano.blogspot.it/2011/08/adding-nuget-support-to-f-interactive.html">blog post</a> from Daniel Mohl where he suggests how to add NuGet support to F# Interactive, but his solution requires the VS Object Model and doesn’t support loose fsx files (without the creation of a F# project).</p>

<p>So I wrote my own “PackageManagement.fsx” file which can be initialized with F# Interactive:</p>

<p><img src="http://tobivnext.files.wordpress.com/2014/03/032614_1615_importnuget1.png?w=580" alt=""></p>

<p>And here is the script code: <a href="https://gist.github.com/toburger/9786275">https://gist.github.com/toburger/9786275</a></p>

<p>It depends on the NuGet.Core.dll which you can get from <a href="http://nuget.codeplex.com/">here</a> and you must define your target NuGet packages directory, where the packages are downloaded and from where they are referenced (you can define the <code>NugetLibDir</code> environment variable so you can use the same script on multiple machines). I ignore the versioning of the packages (I always download the latest stable release), but you can enable it by setting the boolean parameter <code>useSideBySidePaths</code> on line 11 to true.</p>

<h2>So how to work with this script?</h2>

<p>The main command is <code>ipr</code> which stands for “install package and references”, which downloads the package with all its dependencies and adds the references to the clipboard, so the only thing you have to do is to paste the references on top of your script file.</p>

<p>Just enter <code>ipr “package name”;;</code> in the f# Interactive REPL (don’t forget the two semicolons) and it will try it’s best to download and reference the packages.</p>

<p><img src="http://tobivnext.files.wordpress.com/2014/03/032614_1615_importnuget2.png?w=580" alt=""></p>

<p>There are also commands to update and uninstall packages or to simply copy the references without trying to download the latest package.</p>

<h2>Limitations:</h2>

<p>I try my best to find the best matching references for the framework version in which F# interactive runs, but this matching is not bullet proof and unfortunately the NuGet lib doesn’t provide a way to get the best matching references automatically (at least I didn’t found any practical way).</p>

<p>The script should also work without VS and should work on Mono but I don’t have tested it so please feel free to contact me or edit the file if you have any problems.</p>

<hr>

<p>Actually there is now a suggestion on fslang uservoice with a propose to natively support NuGet packages: <a href="http://fslang.uservoice.com/forums/245727-f-language/suggestions/5670137%E2%80%93package-directive-to-import-nuget-packages-in-f">http://fslang.uservoice.com/forums/245727-f-language/suggestions/5670137–package-directive-to-import-nuget-packages-in-f</a></p>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Import+NuGet+packages+to+F%23+interactive+scripts&amp;url=http://toburger.github.io/fsharp/2014/03/26/import-nuget-packages-to-fsharp-interactive-scripts"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/assets/images/author.png)">Blog Logo</div>
              <h4>Tobias Burger</h4>
              <p class="bio"></p>
              <hr>
              <p class="published">Published <time datetime="2014-03-26 00:00">26 Mar 2014</time></p>
            </section>
          </div>
          
          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Proudly published with <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> You should subscribe to my feed.</span></a>
              <div class="inner">
                <section class="copyright">All content copyright <a href="/">Tobias Burger</a> &copy; 2014<br>All rights reserved.</section>
              </div>
            </footer>
          </div>
        </div>
      </article>
    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/cA4aKEIPQrerBnp1yGHv_IMG_9534-3-2.jpg)">
      Image
    </div>
    <div class="inner">
      <h1 class="blog-title">Tobi vNext</h1>
      <h2 class="blog-description">F#, C#, PowerShell and HTML5 developer; interested in everything tech-related with a strong focus on Microsoft technology.</h2>
      <a href="/" class="btn">Back to Overview</a>
    </div>
    </div>
  </body>
</html>
